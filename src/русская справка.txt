Русская справка для файла "save-telegram-stickers-bot.js".
Всё, что написано ниже, относится именно к тому скрипту.
Во всех операциях используйте его, а не этот текстовый документ!

______________________

Это код для Телеграмм-бота, чтобы автоматизировать процесс сохранения всех стикеров из выбранных пачек. Что значительно быстрее, чем сохранять каждый стикер по отдельности.

Для запуска скрипта необходимы:
1) Аккаунт в Telegram;
2) Корректный токен бота;
3) Современный браузер со всяким HTML5.

Будем считать, что аккаунт у вас уже есть. Тогда войдите в него.

Если у вас НЕТ токена бота, то вот инструкция его получения:
1) Начните диалог с бот-пользователем @BotFather и отправьте команду "/start".
2) Отправьте команду "/newbot" и введите имя (которое как фамилия) для бота. Если он станет вашим приватным ботом, можете назвать его "Бот такого-то", например.
3) Отправьте логин (как @имя) для бота. Но он должен быть уникальным (среди всех прочих публичных ботов), и обязан заканчиваться словом "bot", например, "вашлогин_bot".
4) Вы получите токен (HTTP API key) для бота. Ну, можете ещё что-нибудь настроить там.

Чтобы начать сохранять стикеры, откройте браузер. Перейдите на адрес:
https://api.telegram.org/404
Вы увидите JSON текст.

Откройте консоль браузера. Ctrl+Shift+K / Ctrl+Shift+J / F12…
Скопируйте и вставьте туда ВЕСЬ ЭТОТ ФАЙЛ как текст. [имеется в виду "save-telegram-stickers-bot.js"]
Да. И нажмите Enter. Теперь уже можете очистить консоль, если тормозит.

Появится страница с текстовым полем "Your bot token:". Вставьте туда токен своего бота.
Теперь нажмите (один клик левой кнопкой мышки) кнопку "Start!" справа.

Осторожнее, не щёлкайте ничего дважды!

Если сеть в порядке, то вы увидите строку "Bot: ..." ниже.
С правой стороны будет лог действий. А консоль браузера можно закрыть, если устанете читать все сетевые запросы ))

НЕ ЗАБУДЬТЕ:
Сейчас вам следует отправить токен бота ему же через Телеграмм, в простом личном сообщении. Это гарантирует, что он будет отвечать только на ваши запросы.
Бот ответит словом "OK" на ваше сообщение с токеном.

Наконец, для сохранения пачки стикеров, всё что вам нужно - отправить/переслать боту любой стикер.
Если стикер принадлежит пачке, то бот скачает все другие стикеры из неё, преобразует в .png формат, и заархивирует в единый ZIP (и оригиналы и PNG).
Если же это "одиночный стикер" (отправленный как .webp файл, но отображающийся как стикер в Телеграмме), он будет просто скачан, сконвертирован и заархивирован (то есть всего 2 файла в .zip).

Заметьте, что PNG весит больше, чем WEBP, так что ваш бот на самом деле скачал меньше данных, чем объём итогового файла (потом можете отдельно посчитать размеры .webp).

Файлы сохраняются в IndexedDB, локальную базу данных в браузере. Чтобы сохранить их на жёсткий диск, щёлкните на соответствующую ссылку (Blob-адрес), которая появится на странице, когда архив будет готов.
(В некоторых браузерах при сохранении будет предложено неверное имя, так что до щелчка заранее скопируйте название).

Можете отправлять сколько угодно стикеров, но на очень больших пачках браузер может забрать всю системную память и рухнуть...

Чтобы сохранить все уже скачанные пачки разом, можете щёлкнуть ссылку "save all" (вторая на странице). Но нажмите её только один раз, и ждите новой записи на странице ниже. Это будет временный архив (не хранящийся в базе), в котором будут все остальные архивы. Щёлкните и сохраните его!

Если вы обновите страницу, то в следующий раз вам придётся снова вставлять скрипт в консоль браузера, и вводить токен бота (и также отправлять самому боту).
Но если у вас уже есть созданные архивы в локальной базе, то они будут выведены сразу, чтобы вы могли их сохранить на диск.
Кстати, если вы отправите стикер из пачки, которую уже скачивали ранее - она всё равно будет снова закачана, сконвертирована и заархивирована (скорее всего, заменяя предыдущий архив в базе).

Чтобы удалить все локальные архивы из браузера, нажмите первую ссылку на странице ("delete all" / "recreate database"). Подождите, пока страница не обновиться, а потом повторите вставку в консоль, ввод токенов, и т.д.

Этот скрипт специально сделан для "личного" использования, и вы не должны пытаться сделать настоящего "бота, сохраняющего стикеры" подобным образом. Потому что в браузере конвертация и архивация отнимают слишком много процессорного времени (загрузка ЦП), то есть вашу систему можно будет просто повесить, заспамив бота стикерами.

Скрипт проверен и работает в Firefox 19 и Chrome 38.

Код самого бота мой, с лицензией WTFPL.
Однако, ниже используются и чужие библиотеки. Разумеется, их автор не я, а лицензия другая.

Следите за "//" комментариями.

______________________
